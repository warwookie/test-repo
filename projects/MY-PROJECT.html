<!doctype html>
<html lang="en">
<head>
<script src="../js/theme-boot.js"></script>
<script src="../js/feature-flags.js"></script>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"/>
<title>SneakerQuest — Live UI Sandbox — Tasks 7–10</title>


<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
:root{ --baseW:144; --baseH:256; --s:3 }
:root{ --bg:#0d1117; --shell:#e7e3d6; --shell2:#cfcab9; --edge:#2b3344; --crtGrid:#2a3847; --badge:#1b2233; --badgeEdge:#374158; --txt:#e7edf8; --org:#ff7a1b; --ylw:#f0c62e; --red:#e05353; --grey:#3a4459; --hi:#00ffe5; --sel:#ffa600; --green:#18d26e; --burn1:#ff8a3c; --burn2:#e05353; --cyan:var(--hi) }
body.theme-midnight{}
body.theme-classic{}
body.theme-neon{ --bg:#0a0014; --shell:#0f0f1a; --shell2:#1a1a2e; --edge:#2d1b69; --crtGrid:#331a80; --badge:#120a3a; --badgeEdge:#2c1a66; --txt:#e9e6ff; --org:#ff7af6; --ylw:#ffd54a; --red:#ff4d6d; --grey:#463c6b; --hi:#5dff9f; --sel:#39c7ff; --green:#29ffb8; --burn1:#ff9b54; --burn2:#ff477e }
body.theme-dmg{ --bg:#8bac0f; --shell:#c5c7b8; --shell2:#b2b4a6; --edge:#5b615a; --crtGrid:#76806f; --badge:#3a3f38; --badgeEdge:#5b615a; --txt:#e6e8dd; --org:#8c9775; --ylw:#b0b68e; --red:#8b4a4a; --grey:#5b615a; --hi:#b7d17b; --sel:#3a53a5; --green:#6c8b2e; --burn1:#b08f62; --burn2:#8b4a4a }
body.theme-mono{ --bg:#111; --shell:#f3f3f3; --shell2:#dcdcdc; --edge:#333; --crtGrid:#222; --badge:#000; --badgeEdge:#333; --txt:#f5f5f5; --org:#bbb; --ylw:#ddd; --red:#f55; --grey:#444; --hi:#fff; --sel:#888; --green:#9f9; --burn1:#f88; --burn2:#c33 }
body.theme-paper{}
html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:'Press Start 2P', monospace}
*{box-sizing:border-box; image-rendering:pixelated}
#layout-ui{position:relative;z-index:1200}
.app{display:grid; grid-template-columns:minmax(220px, 264px) auto; gap:12px; height:100vh; padding:12px; position:relative}
.palette,.pBar,.pBar .tb,.pBar button,.pBar select,.pBar label{position:relative;z-index:1300;pointer-events:auto}
.stageWrap,.safe916,#root{position:relative;z-index:0}
.modal,.editor{z-index:2000}
.modal[aria-hidden="true"],.editor[aria-hidden="true"]{pointer-events:none}
#layout-ui [data-role="block-palette"]{display:none}
#layout-ui [data-role="layout-inspector"]{pointer-events:auto}
#layout-ui [data-role="layout-inspector"].hidden{display:none!important}
.palette{background:#0b1322;border:1px solid #2a3a54;border-radius:10px;padding:10px;display:grid;grid-template-rows:auto 1fr auto;gap:10px;font:12px/1.2 system-ui,Arial,sans-serif}
.pHead{font-weight:700;color:#bcd2ff; display:flex; align-items:center; justify-content:space-between; gap:8px}
.pHead .right{display:flex; align-items:center; gap:6px}
.pHead select{background:#13213b;color:#e6f0ff;border:1px solid #4d5e85;border-radius:6px;padding:6px 8px}
.pList{display:flex;flex-direction:column;gap:10px;overflow:auto;padding-right:4px}
.pItem{background:#121b2c;border:1px solid #3a4a6a;border-radius:8px;padding:8px;color:#dfe8ff;cursor:pointer;display:flex;align-items:center;gap:8px}
.pItem .swatch{width:16px;height:16px;background:#2a3347;border:1px solid #000}
.pBar{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.pBar button{background:#13213b;color:#e6f0ff;border:1px solid #4d5e85;border-radius:6px;padding:6px 10px;cursor:pointer}
.hidden{display:none!important}
.pBar input[type="checkbox"]{vertical-align:middle}
.tb{display:inline-flex;gap:8px;align-items:center;padding:4px 6px;border-radius:10px;background:rgba(255,255,255,0.04)}
.tb-file{order:1}
.tb-edit{order:2}
.tb-view{order:3;margin-left:auto}
.stageWrap{display:grid;place-items:center}
.safe916{position:relative;width:calc(var(--baseW)*var(--s)*1px);height:calc(var(--baseH)*var(--s)*1px);background:var(--shell);box-shadow:0 0 0 calc(var(--s)*1px)#000,0 0 0 calc(var(--s)*2px)var(--shell2),0 0 0 calc(var(--s)*3px)#000,inset 0 0 0 calc(var(--s)*2px)var(--shell2);border-radius:calc(var(--s)*2px);overflow:hidden;color:#000}
.block{position:absolute;user-select:none;cursor:grab;display:flex;align-items:center;justify-content:center;min-width:calc(var(--s)*8px);min-height:calc(var(--s)*8px);outline:1px solid transparent}
.block:active{cursor:grabbing}
.sel{outline:2px dashed var(--sel);outline-offset:-2px}
.block.locked{outline:2px dotted var(--red);cursor:not-allowed}
.block.locked .handle{display:none}
.handle{position:absolute;width:12px;height:12px;right:-6px;bottom:-6px;background:var(--hi);border:1px solid #003b37;cursor:nwse-resize;border-radius:2px}
.titlePlaque{background:var(--org);color:#000;letter-spacing:calc(var(--s)*.5px);box-shadow:0 0 0 calc(var(--s)*1px)#000,inset 0 0 0 calc(var(--s)*1px)#b35b12;height:calc(var(--s)*14px);font-size:calc(var(--s)*6px);padding:0 calc(var(--s)*6px);display:flex;align-items:center;justify-content:center}
.badge{background:var(--badge);color:var(--txt);height:calc(var(--s)*12px);padding:0 calc(var(--s)*6px);font-size:calc(var(--s)*5px);box-shadow:0 0 0 calc(var(--s)*1px)#000,inset 0 calc(var(--s)*1px) 0 var(--badgeEdge);border-radius:calc(var(--s)*1px);display:flex;align-items:center;gap:calc(var(--s)*4px)}
.badge.column{flex-direction:column;justify-content:center;gap:calc(var(--s)*2px)}
.badge .label{opacity:.8}
/* text host override */
.block .txtHost.hasFS{font-size:var(--fs-override)!important}
.block .txtHost{max-width:100%;max-height:100%;overflow:hidden;text-overflow:ellipsis;white-space:pre-wrap}

/* Inner content positioning + padding */
.block{position:absolute}
.block .innerHost{position:relative; width:100%; height:100%; pointer-events:auto}

.heart{width:calc(var(--s)*4px);height:calc(var(--s)*4px);background:var(--green);display:inline-block;margin-left:calc(var(--s)*2px)}
.heart.burn{background:linear-gradient(180deg,var(--burn1),var(--burn2))}
.shoeSlot{position:relative;width:calc(var(--s)*12px);height:calc(var(--s)*8px);background:#2a3347;border:1px solid #000;display:inline-block}
.shoeSlot:after{content:"";position:absolute;right:calc(var(--s)*1px);bottom:calc(var(--s)*1px);width:calc(var(--s)*3px);height:calc(var(--s)*2px);background:var(--shell)} 
.circSlot{width:calc(var(--s)*8px);height:calc(var(--s)*8px);border-radius:50%;border:1px solid #000;box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);background:transparent;display:inline-block}
.stageTop{font-size:calc(var(--s)*4.5px);line-height:1}
.scoreBottom{font-size:calc(var(--s)*5px);line-height:1}
.timerBadge{font-variant-numeric:tabular-nums}
.timerDigits{display:inline-block;white-space:nowrap;width:11ch;text-align:right}
.timerDigits span{display:inline-block}
.boardSkin{background:#0f1114;box-shadow:0 0 0 calc(var(--s)*2px)#000,inset 0 0 0 calc(var(--s)*2px)var(--edge)}
.grid{position:absolute;inset:calc(var(--s)*3px);pointer-events:none}
.grid.show::before{content:"";position:absolute;inset:0;background-image:linear-gradient(to right,var(--crtGrid) 1px,transparent 1px),linear-gradient(to bottom,var(--crtGrid) 1px,transparent 1px);background-size:calc(var(--s)*8px) calc(var(--s)*8px);opacity:.6}
.ctrlSkin{background:#111825;box-shadow:0 0 0 calc(var(--s)*2px)#000,inset 0 0 0 calc(var(--s)*2px)var(--edge)}
.bombBar{background:#24324c;color:#e6f0ff;border:1px solid #000;box-shadow:inset 0 0 0 rgba(255,255,255,.1);border-radius:calc(var(--s)*4px);height:100%;width:100%;display:flex;align-items:center;justify-content:center}
.joy{width:100%;height:100%;display:grid;place-items:center}
.joy .outer{width:85%;height:85%;border-radius:50%;background:#2e374a;box-shadow:0 0 0 1px #000,inset 0 calc(var(--s)*1px) 0 rgba(255,255,255,.08);display:grid;place-items:center}
.joy .nub{width:45%;height:45%;border-radius:50%;background:#1f2636;box-shadow:0 0 0 1px #000}
.statBox{display:flex;align-items:center;gap:calc(var(--s)*4px)}
.pips{display:flex;gap:calc(var(--s)*2px)}
.pipSq{width:calc(var(--s)*5px);height:calc(var(--s)*5px);background:#2e374a;border:1px solid #000}
.pipFlame{position:relative;width:calc(var(--s)*4px);height:calc(var(--s)*6px);background:#2e374a;border:1px solid #000}
.pipFlame:after{content:"";position:absolute;left:50%;top:10%;width:40%;height:50%;background:#2e374a;border:1px solid #000;transform:translateX(-50%) rotate(45deg)}
.pauseBtn{width:100%;height:100%;display:grid;place-items:center}
.pauseIcon{width:60%;height:60%;border-radius:50%;background:#2e374a;box-shadow:0 0 0 1px #000;display:grid;place-items:center}
.pauseIcon:before,.pauseIcon:after{content:"";display:inline-block;width:18%;height:45%;background:#bcd2ff;margin:0 6%}
.overlay{position:absolute;left:8px;top:8px;z-index:5;display:none}
.overlay button{background:#13213b;color:#e6f0ff;border:1px solid #4d5e85;border-radius:6px;padding:4px 8px;cursor:pointer;font:10px/1.2 ui-monospace,monospace}
.inspEdit label{display:inline-block;margin:2px 6px;}
.inspEdit input{width:64px;text-align:center;}

/* IO Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center}
.card{background:#0b1322;border:1px solid #2a3a54;border-radius:10px;padding:12px;width:min(720px,90vw);display:grid;gap:8px}
.card textarea{width:100%;height:40vh;background:#0e1628;color:#e6f0ff;border:1px solid #3a4a6a;border-radius:6px;padding:8px;font:12px/1.4 ui-monospace,SFMono-Regular,Consolas,monospace}
.card .row{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}
.card button{background:#13213b;color:#e6f0ff;border:1px solid #4d5e85;border-radius:6px;padding:6px 10px;cursor:pointer}
#helpBody ul{margin:6px 0 12px 18px}
/* === Editor Modal === */
.editor{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center}
.edCard{background:#0b1322;border:1px solid #2a3a54;border-radius:12px;padding:12px;display:grid;gap:10px;width:min(980px,95vw);max-height:95vh}
.edHead{display:flex;align-items:center;justify-content:space-between;gap:8px}
.tabs{display:flex;gap:6px;flex-wrap:wrap}
.tab{background:#121b2c;border:1px solid #3a4a6a;border-radius:8px;padding:6px 10px;cursor:pointer;color:#dfe8ff;font:12px/1 ui-sans-serif,system-ui}
.tab.active{outline:2px solid var(--sel)}
.edBody{display:grid;grid-template-columns:1fr min(420px,40vw);gap:10px}
.pane{background:#0e1628;border:1px solid #3a4a6a;border-radius:10px;padding:10px;display:none;color:#e6f0ff}
.pane.active{display:block}
.pane label{display:block;margin:.5rem 0 .25rem 0;font:12px/1 ui-sans-serif}
.pane input,.pane select,.pane textarea{width:100%;background:#0f1b33;color:#e6f0ff;border:1px solid #3a4a6a;border-radius:6px;padding:6px;font:12px/1.2 ui-monospace}
.preview{background:#0e1628;border:1px dashed #3a4a6a;border-radius:10px;padding:10px;display:grid;grid-template-rows:auto 1fr;gap:8px}
.previewTop{display:flex;align-items:center;justify-content:space-between;gap:8px}
.zoomRange{width:160px}
.previewStage{display:grid;place-items:center;overflow:auto;background:#0b1220;border-radius:8px;padding:8px}
.previewWrap{transform-origin:top left}
.edRow{display:flex;gap:8px;flex-wrap:wrap}
.edRow > *{flex:1 1 140px}
/* text fit helpers */
.ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hasFS{font-size:var(--fs-override, inherit)}
.design-preview {
  width: 96px;
  height: 96px;
  border: 2px solid var(--line, #444);
  border-radius: 8px;
  box-shadow: 0 0 0 2px rgba(0,0,0,0.2) inset;
  background:
    linear-gradient(45deg, rgba(0,0,0,0.07) 25%, transparent 25%) 0 0/16px 16px,
    linear-gradient(-45deg, rgba(0,0,0,0.07) 25%, transparent 25%) 0 0/16px 16px,
    linear-gradient(45deg, transparent 75%, rgba(0,0,0,0.07) 75%) 0 0/16px 16px,
    linear-gradient(-45deg, transparent 75%, rgba(0,0,0,0.07) 75%) 0 0/16px 16px;
  background-color: var(--badge, #101014);
  image-rendering: pixelated;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
  display: inline-block;
}
.iconsHost { display:inline-flex; align-items:center; gap:8px; vertical-align:middle; }
.iconToken {
  width: var(--iconSize, 14px);
  height: var(--iconSize, 14px);
  border-radius: 50%;
  background: #000;
  border: 1px solid #222;
  display: inline-block;
}
.labelHost, .iconsHost {
  position: absolute;
  transform: translate(-50%, -50%);
  left: 50%;
  top: 50%;
  pointer-events: auto;
}
.block .labelHost {
  left: var(--cx, 50%);
  top: var(--cy, 50%);
  padding: 0 var(--padx, 0px);
}
.innerHost { position: relative; }
.labelHost{ position:absolute; transform:translate(-50%,-50%); left:50%; top:50%; white-space:nowrap; pointer-events:none; }
.innerHost{ position:relative; }
.labelHost { position:absolute; transform:translate(-50%,-50%); left:50%; top:50%; white-space:pre-line; }
.labelLine { display:block; white-space:nowrap; }
.iconsHost { position:absolute; transform:translate(-50%,-50%); left:50%; top:70%; display:flex; gap:6px; }
/* visual hit target in preview only (added/removed by JS) */
.dragTargetHint { outline:1px dashed #00d1ff; outline-offset:-2px; }
.guide-line {
  position:absolute; pointer-events:none; z-index:9998; opacity:0.7;
  background: var(--cyan);
}
.guide-line.h { height:1px; width:100%; left:0; }
.guide-line.v { width:1px; height:100%; top:0; }
.guide-wrap { position:absolute; inset:0; pointer-events:none; z-index:9997; }
</style>
</head>
<body class="theme-midnight">
<div id="layout-ui" class="app" data-role="layout-ui">
  <div class="palette" data-role="sidebar">
    <div class="pHead">
      <div>Live UI — Palette</div>
    </div>
    <div class="pList" id="palette" data-role="block-palette">
      <button type="button" class="pItem" data-make="_board"><div class="swatch"></div>Game Screen</button>
      <button type="button" class="pItem" data-make="_ctrl"><div class="swatch"></div>Controller Zone</button>
      <button type="button" class="pItem" data-make="title"><div class="swatch"></div>Title plaque</button>
      <button type="button" class="pItem" data-make="snkr"><div class="swatch"></div>Sneakers bar</button>
      <button type="button" class="pItem" data-make="power"><div class="swatch"></div>Power-ups bar</button>
      <button type="button" class="pItem" data-make="life"><div class="swatch"></div>Life hearts</button>
      <button type="button" class="pItem" data-make="score"><div class="swatch"></div>Score + Stage</button>
      <button type="button" class="pItem" data-make="timer"><div class="swatch"></div>Timer</button>
      <button type="button" class="pItem" data-make="bombbar"><div class="swatch"></div>Bomb bar</button>
      <button type="button" class="pItem" data-make="joystick"><div class="swatch"></div>Joystick</button>
      <button type="button" class="pItem" data-make="statBoxes"><div class="swatch"></div>Stat: Boxes</button>
      <button type="button" class="pItem" data-make="statFires"><div class="swatch"></div>Stat: Fires</button>
      <button type="button" class="pItem" data-make="pause"><div class="swatch"></div>Pause</button>
    </div>
    <div class="pBar">
      <div class="tb tb-file" role="group" aria-label="File">
        <button id="export" type="button" title="Open Export / Import">File</button>
        <button id="downloadJson" type="button" title="Download JSON">Download</button>
        <label style="margin-left:8px;">Theme
          <select id="themeSel" aria-label="Theme preset">
            <option value="midnight">midnight</option>
            <option value="classic">classic</option>
            <option value="neon">neon</option>
            <option value="paper">paper</option>
          </select>
        </label>
        <div id="layoutsUI" style="display:inline-flex;gap:6px;align-items:center;">
          <label>Layouts
            <select id="layoutSel" aria-label="Saved layouts">
              <option value="">-- none --</option>
            </select>
          </label>
          <button id="layoutSave"  type="button" title="Save current layout">Save</button>
          <button id="layoutLoad"  type="button" title="Load selected layout">Load</button>
          <button id="layoutDelete" type="button" title="Delete selected layout">Delete</button>
        </div>
        <button id="import" type="button" class="hidden">Import</button><!-- Hidden: unfinished feature -->
      </div>
      <div class="tb tb-edit" role="group" aria-label="Edit">
        <button id="undo" type="button">Undo</button>
        <button id="redo" type="button">Redo</button>
        <span id="histCount" style="opacity:.8;font:11px/1 ui-monospace;">Undo: 0</span>
        <button id="delete" type="button">Delete</button>
        <button id="openEditor" type="button">Block Editor</button>
        <div id="layoutTools" style="display:inline-flex;gap:6px;align-items:center;">
          <select id="alignSel" aria-label="Align">
            <option value="">Align…</option>
            <option value="left">Left</option>
            <option value="centerX">Center X</option>
            <option value="right">Right</option>
            <option value="top">Top</option>
            <option value="middleY">Middle Y</option>
            <option value="bottom">Bottom</option>
          </select>
          <button id="alignApply" type="button">Apply</button>
          <select id="distSel" aria-label="Distribute">
            <option value="">Distribute…</option>
            <option value="h">Horizontal</option>
            <option value="v">Vertical</option>
          </select>
          <button id="distApply" type="button">Apply</button>
          <button id="lockSel" type="button" title="Lock/Unlock selection">Lock</button>
        </div>
        <button id="inspectorBtn" type="button">Inspector</button>
        <button id="dupBlockBtn" class="btn hidden" title="Duplicate selected block" type="button">Duplicate</button><!-- Hidden: unfinished feature -->
        <button id="fitLabelBtn" class="btn hidden" title="Shrink-to-fit label in selected block" type="button">Fit Label</button><!-- Hidden: unfinished feature -->
        <button id="auditTextBtn" class="btn hidden" title="Scan labels for overflow" type="button">Audit Text</button><!-- Hidden: unfinished feature -->
        <button id="tidyTextBtn" class="btn hidden" title="Auto-fit all labels" type="button">Tidy Text</button><!-- Hidden: unfinished feature -->
        <button id="reset" type="button" class="hidden">Reset</button><!-- Hidden: unfinished feature -->
      </div>
      <div class="tb tb-view" role="group" aria-label="View">
        <label><input id="toggleEdit" type="checkbox"> Edit</label>
        <label><input id="toggleGrid" type="checkbox"> Grid</label>
        <label><input id="snapToggle" type="checkbox" checked> Snap</label>
        <label>Step
          <select id="snapStep">
            <option value="1">1× tile</option>
            <option value="0.5">½× tile</option>
          </select>
        </label>
        <label><input id="guideToggle" type="checkbox" checked> Guides</label>
        <div class="hidden" aria-hidden="true">
          <label title="Snap to 8px tiles"><input type="checkbox" id="snapTiles" checked>tiles</label><!-- Hidden: unfinished feature -->
          <label title="Snap edges to other edges"><input type="checkbox" id="snapEdges" checked>edges</label><!-- Hidden: unfinished feature -->
          <label title="Snap centers to other centers"><input type="checkbox" id="snapCenters" checked>centers</label><!-- Hidden: unfinished feature -->
        </div>
        <button id="helpBtn" type="button" title="Show help">?</button>
      </div>
    </div>
  </div>

  <div class="stageWrap" data-role="stage-wrap">
    <div class="safe916" id="root" data-role="stage-root">
      <div class="overlay" id="overlay"><button id="burnToggle" type="button">Toggle heart burn</button></div>
      <div id="guides" class="guide-wrap" aria-hidden="true"></div>
      <div id="board" class="block boardSkin"><div class="grid" id="grid"></div><div class="handle"></div></div>
      <div id="ctrlZone" class="block ctrlSkin"><div class="handle"></div></div>
    </div>
  </div>

  <div id="inspector" class="card hidden" data-role="layout-inspector" style="position:absolute;right:8px;top:56px;z-index:9999;width:220px;">
    <div style="font-weight:700;color:#bcd2ff;">Inspector</div>
    <div class="inspector-body" style="display:grid;gap:6px;font:11px/1.2 ui-monospace;">
      <div><span style="opacity:.7;">id:</span> <span data-field="id">—</span></div>
      <div><span style="opacity:.7;">kind:</span> <span data-field="kind">—</span></div>
      <div><span style="opacity:.7;">x:</span> <span data-field="x">—</span></div>
      <div><span style="opacity:.7;">y:</span> <span data-field="y">—</span></div>
      <div><span style="opacity:.7;">w:</span> <span data-field="w">—</span></div>
      <div><span style="opacity:.7;">h:</span> <span data-field="h">—</span></div>
    </div>
    <div id="inspEdit" class="inspEdit">
      <h4>Edit Layout</h4>
      <label>X <input id="inspX" type="number" step="1"></label>
      <label>Y <input id="inspY" type="number" step="1"></label>
      <label>W <input id="inspW" type="number" step="1" min="1"></label>
      <label>H <input id="inspH" type="number" step="1" min="1"></label>
      <h4>Meta (optional)</h4>
      <label>cx <input id="inspCx" type="text" placeholder="50%"></label>
      <label>cy <input id="inspCy" type="text" placeholder="50%"></label>
      <label>padx <input id="inspPadx" type="text" placeholder="0px"></label>
      <button id="inspApply" type="button">Apply</button>
    </div>
  </div>
</div>

<!-- Export/Import Modal -->
<div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
  <div class="card">
    <b id="modalTitle">File — Export / Import</b>
    <textarea id="io" aria-label="Layout JSON"></textarea>
    <div class="row" id="row-upload">
      <input id="uploadJson" type="file" accept="application/json" />
      <button id="uploadBtn" type="button">Upload</button>
    </div>
    <div class="row" id="row-presets" style="justify-content:flex-start">
      <label for="presetSel" style="color:#bcd2ff">Preset</label>
      <select id="presetSel" aria-label="Preset layout">
        <option value="">-- choose preset --</option>
        <option value="strictDefault">Strict Default (current STRICT_LAYOUT)</option>
        <option value="compactHUD">Compact HUD</option>
        <option value="wideHUD">Wide HUD</option>
      </select>
      <button id="applyPreset" type="button">Apply Preset</button>
    </div>
    <div class="row">
      <button id="copy" type="button">Copy</button>
      <button id="pasteApply" type="button">Apply</button>
      <button id="downloadJsonModal" type="button">Download .json</button>
      <button id="close" type="button">Close</button>
    </div>
  </div>
</div>

<!-- === Editor Modal (Tasks 7–10) === -->
<div class="editor" id="editor">
  <div class="edCard" role="dialog" aria-modal="true" aria-labelledby="edTitle">
    <div class="edHead">
      <div id="edTitle">Block Editor</div>
      <div class="tabs" id="edTabs">
        <div class="tab active" data-tab="text">Text</div>
        <div class="tab" data-tab="icons">Icons</div>
        <div class="tab" data-tab="layout">Layout</div>
        <div class="tab hidden" data-tab="design">Design Generator</div><!-- Hidden: unfinished feature -->
      </div>
      <div class="edRow" style="justify-content:flex-end">
        <button id="edClose" type="button">Close</button>
      </div>
    </div>

    <div class="edBody">
      <div>
        <div class="pane active" id="pane-text">
          <div class="edRow" id="row-single">
            <label>Label text ("\\n" = new line)
              <input id="txtLabel" placeholder="example: SCORE 000000"/>
            </label>
            <label>Font size (px)
              <input id="txtSize" type="number" min="6" max="64" value="12"/>
            </label>
          </div>
          <div class="edRow" id="row-dual" style="display:none">
            <label>Line 1
              <input id="txtLine1" placeholder="e.g. STAGE — ONE"/>
            </label>
            <label>Line 2
              <input id="txtLine2" placeholder="e.g. SCORE 000000"/>
            </label>
            <label>Font size (px)
              <input id="txtSize2" type="number" min="6" max="64" value="12"/>
            </label>
          </div>
          <div class="edRow">
            <label>Horizontal align
              <select id="txtAlignX"><option>left</option><option selected>center</option><option>right</option></select>
            </label>
            <label>Vertical align
              <select id="txtAlignY"><option>top</option><option selected>center</option><option>bottom</option></select>
            </label>
          </div>
          <div class="edRow">
            <label>Padding X (px)
              <input id="padX" type="range" min="0" max="24" step="1" value="0"/>
            </label>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Icon Count</div>
            <div class="dgField">
              <input id="iconCount" type="number" min="0" max="8" step="1" value="0" />
            </div>
          </div>
          <hr style="border:none;border-top:1px solid #24324c;margin:8px 0">
          <div class="edRow">
            <label>Content X (0–100%)
              <input id="contentX" type="range" min="0" max="100" step="1" value="50"/>
            </label>
            <label>Content Y (0–100%)
              <input id="contentY" type="range" min="0" max="100" step="1" value="50"/>
            </label>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Text X (0–100%)</div>
            <div class="dgField"><input id="textX" type="range" min="0" max="100" step="1" value="50"></div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Text Y (0–100%)</div>
            <div class="dgField"><input id="textY" type="range" min="0" max="100" step="1" value="50"></div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Icons X (0–100%)</div>
            <div class="dgField"><input id="iconsX" type="range" min="0" max="100" value="50" step="1"></div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Icons Y (0–100%)</div>
            <div class="dgField"><input id="iconsY" type="range" min="0" max="100" value="50" step="1"></div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Icon Size</div>
            <div class="dgField">
              <input id="iconSize" type="range" min="8" max="36" step="1" value="14" />
              <span id="iconSizeVal" style="margin-left:8px;opacity:.8;">14px</span>
            </div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Move element</div>
            <div class="dgField">
              <select id="moveTarget">
                <option value="line1">Line 1</option>
                <option value="line2">Line 2</option>
                <option value="icons">Icons</option>
              </select>
              <small style="opacity:.7;margin-left:8px;">Drag in preview to move</small>
            </div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Maintenance</div>
            <div class="dgField">
              <button id="cleanExtras" class="btn" title="Remove legacy/demo children from this block, keep label+icons" type="button">Clean extras</button>
            </div>
          </div>
          <label style="display:flex;align-items:center;gap:6px;width:max-content"><input type="checkbox" id="snapInner" checked> Snap inner drag (10%)</label>
          <p style="opacity:.7;margin-top:6px">Tip: drag the content inside the <b>preview</b> to reposition. Sliders update too.</p>
        </div>
        <div class="pane" id="pane-icons">
          <p>Icon controls placeholder. Types, counts, size, gap, align. (Task 11).</p>
        </div>
        <div class="pane" id="pane-layout">
          <div class="edRow">
            <label>X (tiles)
              <input id="layX" type="number"/>
            </label>
            <label>Y (tiles)
              <input id="layY" type="number"/>
            </label>
            <label>W (tiles)
              <input id="layW" type="number"/>
            </label>
            <label>H (tiles)
              <input id="layH" type="number"/>
            </label>
          </div>
          <p style="opacity:.7">Fields mirror selection now. Live apply arrives later.</p>
        </div>
        <div class="pane hidden" id="pane-design"><!-- Hidden: unfinished feature -->
          <div class="edRow">
            <label>Prompt
              <input id="dgPrompt" placeholder="Describe a simple pixel motif"/>
            </label>
            <label>Seed
              <input id="dgSeed" type="number" value="0"/>
            </label>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Sprite JSON</div>
            <div class="dgField">
              <textarea id="dgSpriteJson" rows="6" placeholder='{"name":"sneaker","w":16,"h":16,"pixels":["..##....", "..."]}'></textarea>
            </div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Preview</div>
            <div class="dgField">
              <div id="dgPreview" class="design-preview" role="img" aria-label="Design preview area"></div>
            </div>
          </div>
          <div class="dgRow">
            <div class="dgLabel">Apply</div>
            <div class="dgField">
              <button id="dgApply" class="btn" title="Apply current preview to selected block" type="button">Apply to Block</button>
            </div>
          </div>
          <div class="edRow" style="gap:6px">
            <button id="dgGenerate" type="button">Generate</button>
            <button id="dgRandom" type="button">Randomize</button>
          </div>
          <p style="opacity:.7">Design Generator is planned for Task 12. Buttons are visible so you know where it will be.</p>
        </div>
      </div>

      <div class="preview">
        <div class="previewTop">
          <div>Preview</div>
          <div class="edRow" style="justify-content:flex-end">
            <label>Zoom 100–200%
              <input id="zoom" class="zoomRange" type="range" min="100" max="200" step="10" value="100"/>
            </label>
          </div>
        </div>
        <div class="previewStage">
          <div class="previewWrap" id="previewWrap"></div>
        </div>
      </div>
    </div>
  </div>
</div>













<style id="icon-fix-css">
  .innerHost { position: relative; }
  .labelHost { position: absolute; transform: translate(-50%, -50%); left: 50%; top: 40%; white-space: nowrap; }
  .iconsHost { position: absolute; transform: translate(-50%, -50%); left: 50%; top: 70%; display: flex; gap: 6px; }
  .iconToken { width: var(--iconSize, 14px); height: var(--iconSize, 14px); border-radius: 50%; background: #000; border: 1px solid #222; display: inline-block; }
</style>






  <div id="helpOverlay" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle" aria-hidden="true">
    <div class="card" style="max-width:720px">
      <div class="cardHead">
        <h3 id="helpTitle">Help — Controls & Shortcuts</h3>
        <button id="helpClose" type="button" aria-label="Close">Close</button>
      </div>
      <div class="cardBody" id="helpBody">
        <h4>Selection</h4>
        <ul>
          <li>Click: select one</li>
          <li>Ctrl/Cmd+Click: add/remove from selection</li>
          <li>Lock: prevents move/resize</li>
        </ul>
        <h4>Move &amp; Resize</h4>
        <ul>
          <li>Drag inside block: move (group moves if multi-selected)</li>
          <li>Drag handles: resize</li>
          <li>Arrows: nudge 1 tile • Shift+Arrows: ½ tile</li>
          <li>Alt while dragging: no snapping</li>
        </ul>
        <h4>Align &amp; Distribute</h4>
        <ul>
          <li>Select 2+ blocks → choose Align/Distribute → Apply</li>
        </ul>
        <h4>Snap &amp; Guides</h4>
        <ul>
          <li>Snap toggle + Step (1× or ½× tile)</li>
          <li>Guides: shows edge/center lines when near alignment</li>
        </ul>
        <h4>File</h4>
        <ul>
          <li>Export: JSON with version, meta, layout, coords</li>
          <li>Import: paste or Upload .json (validated)</li>
          <li>Layouts: Save/Load/Delete named layouts</li>
          <li>Theme: selector persists and exports in meta.theme</li>
        </ul>
        <h4>Undo/Redo</h4>
        <ul>
          <li>Undo/Redo buttons; history capped if you added the cap</li>
        </ul>
      </div>
    </div>
  </div>
  <script src="../js/layout-inline.js"></script>
  <script src="../js/constants.js"></script>
  <script src="../js/state.js"></script>
  <script src="../js/selection.js"></script>
  <script src="../js/snap.js"></script>
  <script src="../js/drag.js"></script>
  <script src="../js/layout.js"></script>
  <script src="../js/io.js"></script>
  <script src="../js/editor.js"></script>
  <script src="../js/ui.js"></script>
  <script src="../js/init.js"></script>
  
</body>
</html>
