<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SNEAKERQUEST</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/bold/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #ff3a2f;
            --secondary-color: #d6c7a4;
            --bg-dark: #0a0a0a;
            --bg-medium: #1a1510;
            --bg-light: #2a2119;
            --wood-light: #b99b66;
            --wood-medium: #876a46;
            --wood-dark: #56432e;
            --screen-bg: #0a241f;
            --led-glow: rgba(255, 58, 47, 0.45);
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: var(--bg-dark);
            position: fixed; /* Prevent scrolling */
        }

        body {
            margin: 0;
            background: var(--bg-dark);
            color: var(--secondary-color);
            font-family: system-ui, -apple-system, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 10px;
            overscroll-behavior: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            touch-action: manipulation;
            /* iOS specific */
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        .fixed-container {
            width: min(430px, 95vw);
            height: min(900px, 95vh);
            position: relative;
            transform-origin: center center;
        }

        .cabinet {
            width: 100%;
            height: 100%;
            border-radius: 28px;
            padding: 14px;
            background: 
                radial-gradient(120% 120% at 50% 0, #000 0%, #000 18%, transparent 18%),
                linear-gradient(var(--wood-light), #cbb17d 22%, #a98756 22%, #a98756 23%, 
                var(--wood-medium) 23%, var(--wood-medium) 24%, var(--wood-dark) 24%, 
                var(--wood-dark) 25%, #3d3123 25%, #3d3123 100%);
            box-shadow: 
                inset 0 0 0 2px var(--bg-light),
                0 24px 40px rgba(0,0,0,.5),
                0 6px 0 var(--bg-dark);
        }

        .inner {
            width: 100%;
            height: 100%;
            border-radius: 22px;
            background: linear-gradient(#6c5640, #3c2f23 14%, #2e251d 14%, #2e251d);
            box-shadow: 
                inset 0 0 0 2px var(--bg-light),
                inset 0 0 0 6px var(--bg-medium);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            gap: 15px;
            overflow: hidden;
        }

        /* Marquee section - Fixed for mobile */
        .marquee {
            width: 100%;
            height: 80px; /* Reduced for mobile */
            border-radius: 16px;
            padding: 10px 12px;
            background: linear-gradient(#2a2320, #1d1815);
            box-shadow: 
                inset 0 0 0 2px #120e0c,
                inset 0 0 0 6px #2f2722,
                0 2px 0 #0a0807;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .led {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            background: 
                radial-gradient(circle at 8px 10px, rgba(255,255,255,.1), transparent 28%),
                repeating-linear-gradient(180deg, rgba(0,0,0,.4) 0 3px, transparent 3px 10px),
                #120e0c;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 5px 8px;
            position: relative;
            overflow: hidden;
        }

        .mq-wrap {
            display: grid;
            justify-items: center;
            align-content: center;
            height: 100%;
            width: 100%;
        }

        .mq-title {
            font-size: clamp(18px, 6vw, 24px); /* Responsive font size */
            letter-spacing: 0em;
            text-align: center;
            user-select: none;
            color: var(--primary-color);
            text-shadow: 0 0 2px var(--primary-color), 0 0 8px var(--led-glow);
            animation: led-flicker 3.6s ease-in-out infinite;
            font-family: 'Press Start 2P', system-ui, -apple-system, sans-serif;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        .mq-sub {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            justify-content: center;
            font-size: clamp(6px, 2vw, 7px);
            letter-spacing: .1em;
            margin-top: 4px;
            font-family: 'Press Start 2P', system-ui, -apple-system, sans-serif;
        }

        .mq-sub .chip {
            white-space: nowrap;
        }

        .mq-sub .chip-box {
            padding: 3px 2px;
            border: 1px solid var(--primary-color);
            border-radius: 3px;
            color: var(--primary-color);
            text-shadow: 0 0 2px var(--primary-color);
            animation: led-flicker 3.6s ease-in-out infinite;
        }

        @keyframes led-flicker {
            0% { opacity: 0.96; text-shadow: 0 0 2px var(--primary-color), 0 0 6px rgba(255,58,47,.38), 0 0 12px rgba(255,58,47,.2); }
            50% { opacity: 1; text-shadow: 0 0 2px var(--primary-color), 0 0 9px rgba(255,58,47,.5), 0 0 16px rgba(255,58,47,.28); }
            100% { opacity: 0.97; text-shadow: 0 0 2px var(--primary-color), 0 0 6px rgba(255,58,47,.38), 0 0 12px rgba(255,58,47,.2); }
        }

        .divider {
            width: 100%;
            height: 10px;
            border-radius: 8px;
            background: linear-gradient(#3b3026, #2a231e);
            box-shadow: inset 0 0 0 2px var(--bg-medium);
        }

        .crt-wrap {
            width: 100%;
            height: auto;
            border-radius: 18px;
            padding: 8px;
            background: linear-gradient(#3c2f26, #241e18);
            box-shadow: 
                inset 0 0 0 2px #1a140f,
                inset 0 0 0 6px #2a211a;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .crt {
            width: 100%;
            border-radius: 10px;
            aspect-ratio: 0.94;
            background: 
                linear-gradient(180deg, rgba(255,255,255,.1), transparent 22%),
                linear-gradient(var(--screen-bg), #0b2823);
            box-shadow: 
                inset 0 0 0 2px #0e1412,
                inset 0 0 30px rgba(0,0,0,.6);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* Game Canvas */
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            border-radius: 10px;
            image-rendering: pixelated;
        }

        /* Fullscreen Button - Mobile Optimized */
        .fullscreen-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 32px;
            height: 32px;
            background: rgba(255, 58, 47, 0.9);
            border: 1px solid var(--secondary-color);
            border-radius: 6px;
            color: var(--secondary-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: all 0.3s ease;
            font-size: 14px;
            -webkit-tap-highlight-color: transparent;
        }

        .fullscreen-btn:hover {
            background: var(--secondary-color);
            color: var(--primary-color);
        }

        .fullscreen-btn:active {
            transform: scale(0.95);
        }

        /* Tabs - Fixed for mobile */
        .tabs {
            width: 100%;
            height: 60px; /* Reduced for mobile */
            border-radius: 12px;
            background: linear-gradient(#3a2f26, #2b231d);
            box-shadow: inset 0 0 0 2px #1a1410;
            display: flex;
            gap: 8px;
            padding: 8px;
            text-align: center;
            font-weight: 800;
            letter-spacing: 0.06em;
            margin-top: -12px;
            padding-left: 6px;
            padding-right: 6px;
        }
        .tabs .tab:nth-child(1){ flex: 0 1 42%; }
        .tabs .tab:nth-child(2){ flex: 0 1 10%; }
        .tabs .tab:nth-child(3){ flex: 0 1 42%; }

        .tab {
            display: flex;
            align-items: stretch;
            flex: 1;
        }

        .tab .led {
            height: 100%;
            border-radius: 8px;
            padding: 6px 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .tab .led .line {
            font-size: clamp(8px, 2.5vw, 10px);
            letter-spacing: .1em;
            color: var(--primary-color);
            font-weight: 800;
            text-shadow: 0 0 2px var(--primary-color);
            animation: led-flicker 3.6s ease-in-out infinite;
            font-family: 'Press Start 2P', system-ui, -apple-system, sans-serif;
        }

        /* HUD Sections - Fixed for mobile */
        .hud {
            width: 100%;
            height: auto;
            display: flex;
            gap: 3px;
            margin-top: -14px;
        }
        .hud .slot-heart{ height: 36px; }
        .hud .slot-shoes{ height: 36px; }
        .hud .slot-dots{ height: 36px; }
        .hud .slot:nth-child(1){ flex: 0 1 40%; }
        .hud .slot:nth-child(2){ flex: 0 1 28%; }
        .hud .slot:nth-child(3){ flex: 0 1 40%; }

        .hud2 {
            width: 100%;
            height: auto;
            display: flex;
            gap: 3px;
            margin-top: -12px;
        }
        .hud2 .slot-flames{ height: 36px; }
        .hud2 .slot-pause{ height: 36px; }
        .hud2 .slot-bag{ height: 36px; }
        .hud2 .slot:nth-child(1){ flex: 0 1 40%; }
        .hud2 .slot:nth-child(2){ flex: 0 1 28%; }
        .hud2 .slot:nth-child(3){ flex: 0 1 40%; }

        .slot {
            background: linear-gradient(#3a3227, #2c251e);
            border-radius: 12px;
            padding: 4px;
            box-shadow: 
                inset 0 0 0 2px #1a1511,
                0 2px 0 #0b0907;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            height: 100%;
            width: 100%;
        }

        .slot > .led {
            height: 100%;
            width: 100%;
            border-radius: 8px;
            padding: 6px 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slot > .led .line {
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: .1em;
            width: 100%;
            justify-content: center;
        }

        /* Icon Containers */
        #ui-sneakers, #ui-hearts, #ui-fires, #ui-powers {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            padding: 0 3px;
            box-sizing: border-box;
        }

        /* Icon sizes adjusted for mobile */
        .sneaker-icon, .heart-icon, .fire-icon, .power {
            transform: scale(0.9); /* Slightly smaller for mobile */
        }

        .sneaker-outline, .sneaker-fill,
        .heart-outline, .heart-fill,
        .fire-outline, .fire-fill,
        .power .ph-bold, .power .ph-fill {
            font-size: 18px !important; /* Smaller icons */
        }

        .chip-btn {
            background: transparent;
            border: 0;
            border-radius: 0;
            padding: 0;
            display: grid;
            place-items: center;
            position: relative;
            color: var(--primary-color);
            font: inherit;
            letter-spacing: .1em;
            cursor: pointer;
            min-height: 1em;
            line-height: 1;
            min-width: 5ch;
            font-size: clamp(10px, 3vw, 12px);
            font-family: 'Press Start 2P', system-ui, -apple-system, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        .counter {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--primary-color);
            text-shadow: 0 0 6px var(--primary-color), 0 0 18px rgba(255,58,47,.45);
            font-weight: 900;
            letter-spacing: .12em;
        }

        .seven {
            font-family: 'Press Start 2P', ui-monospace, Menlo, Consolas, monospace;
            font-size: clamp(12px, 3.5vw, 14px);
            color: var(--secondary-color);
        }

        .counter .ph-package {
            font-size: 18px !important;
            color: var(--secondary-color) !important;
            filter: none !important;
        }

        .bottom {
            width: 100%;
            height: 130px; /* Reduced for mobile */
            margin-top: -10px;
        }

        .control-screen {
            position: relative;
            height: 100%;
            border-radius: 16px;
            padding: 12px;
            display: grid;
            grid-template-columns: 82% 20%;
            gap: 12px;
            align-items: center;
            overflow: hidden;
            background: linear-gradient(#1a1210, #0c0908);
            box-shadow: 
                inset 0 0 0 2px #1a1510,
                inset 0 16px 30px rgba(0,0,0,.4),
                0 3px 0 #0a0807;
        }

        .matrix {
            position: absolute;
            inset: 6px;
            border-radius: 12px;
            opacity: .9;
            mix-blend-mode: screen;
            pointer-events: none;
            background: radial-gradient(circle at center, #140202 40%, #090101 42%, transparent 43%) 0 0 / 10px 10px repeat;
        }

        /* iPhone notch support */
        @supports (padding: max(0px)) {
            body {
                padding-left: max(10px, env(safe-area-inset-left));
                padding-right: max(10px, env(safe-area-inset-right));
                padding-top: max(10px, env(safe-area-inset-top));
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }
        }

        /* Very small screens (iPhone 8 is 375px wide) */
        @media (max-width: 400px) {
            .inner {
                padding: 12px;
                gap: 12px;
            }
            
            .marquee {
                height: 70px;
            }
            
            .mq-title {
                font-size: 16px;
            }
            
            .tabs {
                height: 55px;
            }
            
            .hud .slot-heart, 
            .hud .slot-shoes, 
            .hud .slot-dots,
            .hud2 .slot-flames,
            .hud2 .slot-pause,
            .hud2 .slot-bag {
                height: 32px;
            }
            
            .bottom {
                height: 120px;
            }
            
            .sneaker-outline, .sneaker-fill,
            .heart-outline, .heart-fill,
            .fire-outline, .fire-fill,
            .power .ph-bold, .power .ph-fill {
                font-size: 16px !important;
            }
        }

        /* Portrait orientation fixes */
        @media (orientation: portrait) and (max-height: 700px) {
            .fixed-container {
                height: min(900px, 90vh);
            }
            
            .inner {
                gap: 10px;
            }
            
            .marquee {
                height: 65px;
            }
            
            .crt-wrap {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="fixed-container" id="mainContainer">
        <div class="cabinet">
            <div class="inner">
                <div class="marquee" id="element-marquee">
                    <div class="led">
                        <div class="mq-wrap">
                            <div class="line mq-title" id="titleSQ">SNEAKERQUEST</div>
                            <div class="line mq-sub">
                                <span class="chip chip-stage chip-box">STAGE&nbsp;–&nbsp;01</span>
                                <span class="chip chip-time chip-box">00:00:0</span>
                                <span class="chip chip-score chip-box">SCORE&nbsp;000000</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="divider" id="element-divider"></div>

                <div class="crt-wrap" id="element-crt">
                    <div class="crt">
                        <button class="fullscreen-btn" id="fullscreenBtn" title="Toggle Fullscreen">
                            <i class="ph-fill ph-arrows-out-simple"></i>
                        </button>
                        <canvas id="gameCanvas"></canvas>
                    </div>
                </div>

                <div class="tabs" id="element-tabs">
                    <div class="tab"><div class="led"><div class="line">SNEAKERS</div></div></div>
                    <div class="tab"><div class="led"><div class="line">LIFE</div></div></div>
                    <div class="tab"><div class="led"><div class="line">POWER-UPS</div></div></div>
                </div>

                <div class="hud" id="element-hud1">
                    <div class="slot slot-heart"><div class="led"><div class="line" aria-label="Sneakers" id="ui-sneakers"></div></div></div>
                    <div class="slot slot-shoes"><div class="led"><div class="line" aria-label="Hearts" id="ui-hearts"></div></div></div>
                    <div class="slot slot-dots"><div class="led"><div class="line" aria-label="Powers" id="ui-powers"></div></div></div>
                </div>

                <div class="hud2" id="element-hud2">
                    <div class="slot slot-flames"><div class="led"><div class="line" aria-label="Fire" id="ui-fires"></div></div></div>
                    <div class="slot slot-pause"><div class="led"><div class="line" aria-label="Pause / Play">
                        <button class="chip-btn" id="btn-pause" type="button" aria-pressed="false" aria-label="Pause" data-state="playing">
                            <span class="word word-pause" aria-hidden="false">PAUSE</span>
                            <span class="word word-play" aria-hidden="true">PLAY</span>
                        </button>
                    </div></div></div>
                    <div class="slot slot-bag"><div class="led"><div class="line counter" aria-label="Box count">
                        <i class="ph-fill ph-package" aria-hidden="true"></i>
                        <span style="opacity:.8;letter-spacing:.12em">x</span>
                        <span class="seven" id="counter">000</span>
                    </div></div></div>
                </div>

                <div class="bottom" id="element-bottom">
                    <div class="control-screen" id="element-controls">
                        <div class="matrix" aria-hidden="true"></div>
                        <main class="control-ui" aria-label="Control surface">
                            <section class="col-left"><div class="pad"></div></section>
                            <section class="col-right"><div class="pad"></div></section>
                        </main>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === MOBILE-FIRST FULLSCREEN MANAGER ===
        class FullscreenManager {
            static initialize() {
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                if (fullscreenBtn) {
                    fullscreenBtn.addEventListener('click', FullscreenManager.toggleFullscreen);
                    fullscreenBtn.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        FullscreenManager.toggleFullscreen();
                    });
                }

                // iOS specific: try to hide address bar
                if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
                    window.addEventListener('load', function() {
                        setTimeout(function() {
                            window.scrollTo(0, 1);
                        }, 100);
                    });
                }
            }

            static toggleFullscreen() {
                // For iOS, we use a different approach since fullscreen API is restricted
                if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
                    FullscreenManager.toggleIOSFullscreen();
                    return;
                }

                try {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen?.().catch(err => {
                            console.log('Fullscreen not supported:', err);
                            FullscreenManager.toggleFallbackFullscreen();
                        });
                    } else {
                        document.exitFullscreen?.();
                    }
                } catch (err) {
                    console.log('Fullscreen error:', err);
                    FullscreenManager.toggleFallbackFullscreen();
                }
            }

            static toggleIOSFullscreen() {
                // iOS doesn't support true fullscreen, but we can maximize the experience
                const body = document.body;
                const isMaximized = body.classList.contains('ios-maximized');
                
                if (!isMaximized) {
                    body.classList.add('ios-maximized');
                    // Hide URL bar by scrolling
                    window.scrollTo(0, 1);
                    // Add iOS fullscreen styles
                    document.documentElement.style.overflow = 'hidden';
                    body.style.padding = '0';
                    body.style.background = '#000';
                } else {
                    body.classList.remove('ios-maximized');
                    document.documentElement.style.overflow = '';
                    body.style.padding = '';
                    body.style.background = '';
                }
                
                // Update button text
                const btn = document.getElementById('fullscreenBtn');
                if (btn) {
                    btn.innerHTML = isMaximized ? 
                        '<i class="ph-fill ph-arrows-out-simple"></i>' : 
                        '<i class="ph-fill ph-arrows-in-simple"></i>';
                }
            }

            static toggleFallbackFullscreen() {
                // Fallback for when fullscreen API fails
                const body = document.body;
                const container = document.getElementById('mainContainer');
                
                if (!body.classList.contains('fallback-fullscreen')) {
                    body.classList.add('fallback-fullscreen');
                    container.style.transform = 'scale(1)';
                    document.documentElement.style.overflow = 'hidden';
                } else {
                    body.classList.remove('fallback-fullscreen');
                    document.documentElement.style.overflow = '';
                    ScalingManager.scaleContainer();
                }
            }
        }

        // === RESPONSIVE SCALING MANAGER ===
        class ScalingManager {
            static initialize() {
                ScalingManager.scaleContainer();
                
                // Use resize observer for better performance
                const resizeObserver = new ResizeObserver(entries => {
                    ScalingManager.scaleContainer();
                });
                
                resizeObserver.observe(document.body);
                
                // Also listen to orientation changes
                window.addEventListener('orientationchange', () => {
                    setTimeout(ScalingManager.scaleContainer, 300);
                });
            }
            
            static scaleContainer() {
                const container = document.querySelector('.fixed-container');
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                // Use more conservative scaling for mobile
                const scaleX = (viewportWidth - 20) / 430;
                const scaleY = (viewportHeight - 20) / 900;
                let finalScale = Math.min(scaleX, scaleY, 1);
                
                // On very small screens, don't scale below 0.8
                finalScale = Math.max(finalScale, 0.8);
                
                container.style.transform = `scale(${finalScale})`;
            }
        }

        // === ICON MANAGER (Same as before) ===
        class IconManager {
            static updateAllIcons() {
                IconManager.renderSneakers(0, 4);
                IconManager.renderHearts(3, 3);
                IconManager.renderPowers(0, 4);
                IconManager.renderFires(0, 5);
            }
            
            static renderSneakers(fill, outline) {
                const container = document.getElementById('ui-sneakers');
                if (!container) return;
                container.innerHTML = '';
                for (let i = 0; i < outline; i++) {
                    const isFilled = i < fill;
                    container.innerHTML += `
                        <div class="sneaker-icon ${isFilled ? 'active' : ''}">
                            <i class="ph-bold ph-sneaker sneaker-outline" aria-hidden="true"></i>
                            <i class="ph-fill ph-sneaker sneaker-fill" aria-hidden="true"></i>
                        </div>
                    `;
                }
            }
            
            static renderHearts(fill, outline) {
                const container = document.getElementById('ui-hearts');
                if (!container) return;
                container.innerHTML = '';
                for (let i = 0; i < outline; i++) {
                    const isFilled = i < fill;
                    container.innerHTML += `
                        <div class="heart-icon ${isFilled ? 'active' : ''}">
                            <i class="ph-bold ph-heart heart-outline" aria-hidden="true"></i>
                            <i class="ph-fill ph-heart heart-fill" aria-hidden="true"></i>
                        </div>
                    `;
                }
            }
            
            static renderFires(fill, outline) {
                const container = document.getElementById('ui-fires');
                if (!container) return;
                container.innerHTML = '';
                for (let i = 0; i < outline; i++) {
                    const isFilled = i < fill;
                    container.innerHTML += `
                        <div class="fire-icon ${isFilled ? 'active' : ''}">
                            <i class="ph-bold ph-fire fire-outline" aria-hidden="true"></i>
                            <i class="ph-fill ph-fire fire-fill" aria-hidden="true"></i>
                        </div>
                    `;
                }
            }
            
            static renderPowers(total, fill) {
                const container = document.getElementById('ui-powers');
                if (!container) return;
                container.innerHTML = '';
                const powerTypes = [
                    { bold: 'ph-timer', fill: 'ph-timer' },
                    { bold: 'ph-shield', fill: 'ph-shield' },
                    { bold: 'ph-magnet', fill: 'ph-magnet' },
                    { bold: 'ph-crosshair-simple', fill: 'blast' }
                ];
                
                for (let i = 0; i < total; i++) {
                    const powerType = powerTypes[i % powerTypes.length];
                    const isActive = i < fill;
                    
                    if (powerType.fill === 'blast') {
                        container.innerHTML += `
                            <div class="power ${isActive ? 'active' : ''}">
                                <i class="ph-bold ph-crosshair-simple" aria-hidden="true"></i>
                                <i class="ph-fill ph-crosshair-simple" aria-hidden="true"></i>
                            </div>
                        `;
                    } else {
                        container.innerHTML += `
                            <div class="power ${isActive ? 'active' : ''}">
                                <i class="ph-bold ${powerType.bold}" aria-hidden="true"></i>
                                <i class="ph-fill ${powerType.fill}" aria-hidden="true"></i>
                            </div>
                        `;
                    }
                }
            }
        }

        // === SIMPLE GAME PLACEHOLDER ===
        function setupSimpleGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            function resizeCanvas() {
                const crt = document.querySelector('.crt');
                const rect = crt.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
                draw();
            }
            
            function draw() {
                ctx.fillStyle = '#0a241f';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#d6c7a4';
                ctx.font = '16px "Press Start 2P"';
                ctx.textAlign = 'center';
                ctx.fillText('SNEAKER BOMBER', canvas.width / 2, canvas.height / 2 - 20);
                ctx.fillText('SPACE TO START', canvas.width / 2, canvas.height / 2 + 20);
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            document.addEventListener('keydown', function(e) {
                if (e.code === 'Space') {
                    ctx.fillStyle = '#ff3a2f';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '14px "Press Start 2P"';
                    ctx.fillText('GAME STARTED!', canvas.width / 2, canvas.height / 2);
                }
            });
        }

        // === INITIALIZE EVERYTHING ===
        document.addEventListener('DOMContentLoaded', function() {
            FullscreenManager.initialize();
            ScalingManager.initialize();
            IconManager.updateAllIcons();
            setupSimpleGame();
            
            // Setup pause button
            const pauseBtn = document.getElementById('btn-pause');
            if (pauseBtn) {
                pauseBtn.addEventListener('click', function() {
                    const isPlaying = this.dataset.state === 'playing';
                    this.dataset.state = isPlaying ? 'paused' : 'playing';
                });
            }
            
            // Prevent default touch behaviors
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('touchend', function(e) {
                e.preventDefault();
            }, { passive: false });
            
            // Initial UI update
            setTimeout(() => {
                window.SneakerQuestUI?.setSneakers?.(2, 4);
                window.SneakerQuestUI?.setHearts?.(2, 3);
                window.SneakerQuestUI?.setCounter?.(125);
                window.SneakerQuestUI?.setScore?.(2500);
            }, 500);
        });

        // Global UI API
        window.SneakerQuestUI = {
            IconManager: IconManager,
            setSneakers: (filled, total) => IconManager.renderSneakers(filled, total),
            setHearts: (filled, total) => IconManager.renderHearts(filled, total),
            setPowers: (filled, total) => IconManager.renderPowers(total, filled),
            setFires: (filled, total) => IconManager.renderFires(filled, total),
            setCounter: (value) => {
                const counter = document.getElementById('counter');
                if (counter) counter.textContent = value.toString().padStart(3, '0');
            },
            setStage: (stage) => {
                const stageElement = document.querySelector('.chip-stage');
                if (stageElement) stageElement.textContent = `STAGE – ${stage.toString().padStart(2, '0')}`;
            },
            setScore: (score) => {
                const scoreElement = document.querySelector('.chip-score');
                if (scoreElement) scoreElement.textContent = `SCORE ${score.toString().padStart(6, '0')}`;
            },
            setTime: (time) => {
                const timeElement = document.querySelector('.chip-time');
                if (timeElement) timeElement.textContent = time;
            }
        };
    </script>
</body>
</html>
