<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Accessible Starter Website</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <noscript>
      <p class="no-script">JavaScript is disabled in your browser. Some interactive features may not work as expected.</p>
    </noscript>
    <a class="skip-link" href="#main-content">Skip to main content</a>

    <!-- Site Header -->
    <header class="site-header" role="banner">
      <div class="container">
        <h1 class="site-title">Rawoul — Starter Website</h1>
        <!-- Primary Navigation -->
        <nav class="primary-nav" aria-label="Primary navigation">
          <ul>
            <li><a href="#section-intro">Intro</a></li>
            <li><a href="#section-features">Features</a></li>
            <li><a href="#section-contact">Contact</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="site-main" tabindex="-1">
      <div class="container">
        <!-- Intro Section -->
        <section id="section-intro" aria-labelledby="intro-heading">
          <h2 id="intro-heading">Welcome</h2>
          <p>
            This minimal starter layout provides a solid foundation for building an
            accessible, responsive website. Customize these sections with your own content.
          </p>
        </section>

        <!-- Features Section -->
        <section id="section-features" aria-labelledby="features-heading">
          <h2 id="features-heading">Key Highlights</h2>
          <ul>
            <li>Semantic HTML5 structure for improved accessibility.</li>
            <li>Responsive design that adapts to a range of devices.</li>
            <li>Baseline styles with focus on readability and usability.</li>
          </ul>
        </section>

        <!-- Contact Section -->
        <section id="section-contact" aria-labelledby="contact-heading">
          <h2 id="contact-heading">Get in Touch</h2>
          <p>
            Ready to make this template your own? Replace this placeholder content with your
            contact details or a call to action to connect with your audience.
          </p>
          <p>Email: <a href="mailto:you@example.com">you@example.com</a></p>
        </section>

        <section>
          <h2>Projects</h2>
          <ul>
            <li><a href="#">Project One</a> — short one-line description.</li>
            <li><a href="#">Project Two</a> — short one-line description.</li>
          </ul>
        </section>
      </div>
    </main>

    <!-- Site Footer -->
    <footer class="site-footer" role="contentinfo">
      <div class="container">
        <p>&copy; <span id="current-year"></span> Starter Website. All rights reserved.</p>
      </div>
    </footer>

    <script src="js/app.js"></script>
    <script>
      /* === SEP-2: Icon generator + text coexist fix === */
      (function () {
        if (window.__sep2Bound) return;
        window.__sep2Bound = true;

        // Utility: get selected block
        function getSel() {
          return document.querySelector('.block.sel') || window.selected || null;
        }

        // Ensure iconsHost exists
        function ensureIconsHost(block) {
          if (!block) return null;
          let icons = block.querySelector('.iconsHost');
          if (!icons) {
            icons = document.createElement('span');
            icons.className = 'iconsHost';
            const inner = block.querySelector('.innerHost') || block;
            inner.appendChild(icons);
          }
          return icons;
        }

        // Create icons inside block
        function rebuildIcons(block, count) {
          const host = ensureIconsHost(block);
          host.innerHTML = '';
          for (let i = 0; i < count; i++) {
            const icon = document.createElement('span');
            icon.className = 'iconToken';
            host.appendChild(icon);
          }
        }

        // Find "Icon Count" input dynamically
        let targetInput = null;
        document.querySelectorAll('input').forEach((inp) => {
          if (inp.previousElementSibling?.textContent?.match(/Icon Count/i)) targetInput = inp;
        });

        if (!targetInput) {
          console.warn('[SEP-2] No Icon Count input found');
          return;
        }

        // Bind events to the Icon Count field
        targetInput.addEventListener('input', () => {
          const block = getSel();
          if (!block) return;
          const n = Math.max(0, parseInt(targetInput.value) || 0);
          rebuildIcons(block, n);
        });

        targetInput.addEventListener('change', () => {
          const block = getSel();
          if (!block) return;
          const n = Math.max(0, parseInt(targetInput.value) || 0);
          rebuildIcons(block, n);
          if (window.snapshot) window.snapshot();
        });

        console.log('[SEP-2] Text + Icons unified successfully');
      })();
    </script>
  </body>
</html>
